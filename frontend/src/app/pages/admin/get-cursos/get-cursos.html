<div class="dashboard-layout">
    <aside class="sidebar">
        <div class="logo">
            <img src="/assets/LogoDigital.png" alt="Logo Digital Academy" class="logo-img" />
        </div>
        <nav>
            <ul class="nav-list">
                <li class="nav-item">
                    <a class="nav-link" routerLink="/admin/home"
                        [ngClass]="{'nav-link-active': activeLink==='home', 'nav-link-inactive': activeLink!=='home'}"
                        (click)="setActive('home')">
                        <i class="bi bi-house-fill nav-icon"></i>
                        <span>Home</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" routerLink="/admin/getUsuario"
                        [ngClass]="{'nav-link-active': activeLink==='gestion-usuarios', 'nav-link-inactive': activeLink!=='gestion-usuarios'}"
                        (click)="setActive('gestion-usuarios')">
                        <i class="bi bi-people-fill nav-icon"></i>
                        <span>Gestión Usuarios</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" routerLink="/admin/getCursos"
                        [ngClass]="{'nav-link-active': activeLink==='gestion-cursos', 'nav-link-inactive': activeLink!=='gestion-cursos'}"
                        (click)="setActive('gestion-cursos')">
                        <i class="bi bi-journal-bookmark-fill nav-icon"></i>
                        <span>Gestión Cursos</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" routerLink="/admin/reportesProgresos"
                        [ngClass]="{'nav-link-active': activeLink==='reportes', 'nav-link-inactive': activeLink!=='reportes'}"
                        (click)="setActive('reportes')">
                        <i class="bi bi-graph-up-arrow nav-icon"></i>
                        <span>Reportes y Progreso</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <div class="main-wrapper">

        <div class="top-bar">
            <h1 class="page-title">GESTIÓN CURSOS</h1>
            <div class="user-menu-wrapper">
                <div class="user-menu" (click)="toggleUserMenu()">
                    <div class="user-avatar">
                        <img src="https://placehold.co/35x35/4A90E2/ffffff?text=A" alt="Avatar">
                    </div>
                    <span class="user-info">Administrador</span>
                    <i class="bi bi-chevron-down" [class.rotate]="userMenuOpen"></i>
                </div>
                <div class="user-dropdown-menu" [class.visible]="userMenuOpen">
                    <a class="dropdown-item logout" (click)="logout()">
                        <i class="bi bi-box-arrow-right"></i>
                        <span>Cerrar Sesión</span>
                    </a>
                </div>
            </div>
        </div>

        <div class="gestion-cursos-container">

            <div class="cursos-top-actions">
                <div class="cursos-search-bar">
                    <input type="text" placeholder="Búsqueda por nombre o editor responsable." class="search-input">
                    <button class="btn-primary-action btn-search">
                        <i class="bi bi-search"></i>
                        Buscar
                    </button>
                </div>

                <button class="btn-primary-action btn-add-course" (click)="openAddCourseModal()">
                    <i class="bi bi-plus-lg"></i>
                    Agregar Curso
                </button>
            </div>

            <div class="cursos-grid">

                <div class="course-card-add-new" (click)="openAddCourseModal()">
                    <div class="add-icon">
                        <i class="bi bi-plus-lg"></i>
                    </div>
                </div>

                <div class="course-card" *ngFor="let curso of cursos">
                    <div class="card-category">{{ curso.categoria?.nombre }}</div>
                    <img src="https://placehold.co/400x200/90B7D7/FFFFFF/png?text=IMAGEN+CURSO" alt="Portada de Curso"
                        class="card-image">
                    <div class="card-body">
                        <h4 class="course-title">{{ curso.titulo }}</h4>
                        <p class="course-editor">{{ curso.editor?.nombre }}</p>
                        <div class="course-meta">
                            <span><i class="bi bi-book-fill"></i> {{ curso.modulos?.length || 0 }} secciones </span>
                        </div>
                        <div class="course-actions">
                            <i class="bi bi-pencil-square action-edit"></i>
                            <i class="bi bi-trash3 action-delete"></i>
                        </div>
                    </div>
                </div>

                <div class="course-card" *ngFor="let curso of cursos">
                    <div class="card-category">{{ curso.categoriaNombre }}</div>
                    <img [src]="curso.imagenUrl || 'https://placehold.co/400x200/90B7D7/FFFFFF/png?text=IMAGEN+CURSO'"
                        alt="Portada de Curso" class="card-image">
                    <div class="card-body">
                        <h4 class="course-title">{{ curso.titulo }}</h4>
                        <p class="course-editor">{{ curso.editorNombre }}</p>
                        <div class="course-meta">
                            <span><i class="bi bi-book-fill"></i> {{ curso.modulos?.length || 0 }}</span>
                        </div>
                        <div class="course-actions">
                            <i class="bi bi-pencil-square action-edit"></i>
                            <i class="bi bi-trash3 action-delete"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" [style.display]="modalOpen ? 'flex' : 'none'">
    <div class="modal-card modal-agregar-curso">
        <h3 class="modal-title">AGREGAR CURSO</h3>
        <button class="btn-eye-toggle close-button" (click)="closeModal()">
            <i class="bi bi-x-lg"></i>
        </button>

        <div class="upload-area" (click)="triggerFileInput()">
            <i class="bi bi-cloud-upload-fill"></i>
            <p>Subir portada del Curso</p>
        </div>

        <input type="file" #fileInput accept="image/*" style="display:none" (change)="onFileSelected($event)">

        <div class="modal-form-grid">

            <div class="form-group full-width">
                <label for="new-nombre">Nombre</label>
                <input type="text" id="new-nombre" name="titulo">
            </div>

            <div class="form-group full-width">
                <label for="new-descripcion">Descripción</label>
                <textarea id="new-descripcion" rows="3" name="descripcion"></textarea>
            </div>

            <div class="form-group full-width">
                <label for="new-categoria">Categoría</label>
                <div class="custom-select-wrapper">
                    <select id="new-categoria" name="categoriaId">
                        <option value="" disabled selected>Selecciona una categoría</option>
                        <option></option>
                    </select>
                </div>
            </div>

            <div class="form-group full-width">
                <label for="new-editor">Editor Responsable</label>
                <div class="custom-select-wrapper">
                    <select id="new-editor" name="editorId">
                        <option value="" disabled selected>Selecciona un editor</option>
                        <option></option>
                    </select>
                </div>
            </div>

        </div>

        <button class="btn-primary-action btn-modal-create">CREAR</button>
    </div>
</div>